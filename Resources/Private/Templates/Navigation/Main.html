<f:comment>
<!--
 * (c) Kitodo. Key to digital objects e.V. <contact@kitodo.org>
 *
 * This file is part of the Kitodo and TYPO3 projects.
 *
 * @license GNU General Public License version 3 or later.
 * For the full copyright and license information, please read the
 * LICENSE.txt file that was distributed with this source code.
-->
</f:comment>
<html xmlns:f="http://typo3.org/ns/TYPO3/CMS/Fluid/ViewHelpers"
      data-namespace-typo3-fluid="true">

<f:comment>Render all navigation features in the given order.</f:comment>
<f:for each="{features}" key="feature" as="enabled">
    <f:if condition="{feature}">
        <f:render section="render.{feature}" arguments="{_all}"/>
    </f:if>
</f:for>

<f:comment>One section for each feature.</f:comment>
<f:section name="render.doublepage">
    <f:if condition="{numPages} > 0">
        <f:then>
            <f:if condition="{viewData.requestData.double}">
                <f:then>
                    <div class="tx-dlf-navigation-double">
                        <f:link.action addQueryString="1" addQueryStringMethod="GET" additionalParams="{'tx_dlf[double]':'0'}">
                            <f:translate key="doublePageOn"/>
                        </f:link.action>
                    </div>
                    <div class="tx-dlf-navigation-double+">
                        <f:if condition="{viewData.requestData.double} && ({viewData.requestData.page} < {numPages})">
                            <f:then>
                                <f:link.action addQueryString="1" addQueryStringMethod="GET" additionalParams="{'tx_dlf[page]':'{viewData.requestData.page + 1}'}">
                                    <f:translate key="doublePage+1"/>
                                </f:link.action>
                            </f:then>
                            <f:else>
                                <span title="{f:translate(key: 'doublePage+1')}">
                                    <f:translate key="doublePage+1"/>
                                </span>
                            </f:else>
                        </f:if>
                    </div>
                </f:then>
                <f:else>
                    <f:link.action addQueryString="1" addQueryStringMethod="GET" additionalParams="{'tx_dlf[double]':'1'}">
                        <f:translate key="doublePageOn"/>
                    </f:link.action>
                </f:else>
            </f:if>
        </f:then>
        <f:else>
            <div class="tx-dlf-navigation-double">
                <span title="{f:translate(key: 'doublePageOn')}">
                    <f:translate key="doublePageOn"/>
                </span>
            </div>
        </f:else>
    </f:if>
</f:section>

<f:section name="render.pageFirst">
    <div class="tx-dlf-navigation-first">
        <f:link.action class="page-first {f:if(condition: \"{viewData.requestData.page} <= 1\", then: \"disabled:\")}" addQueryString="1" addQueryStringMethod="GET" additionalParams="{'tx_dlf[page]':'1'}">
            <f:translate key="firstPage"/>
        </f:link.action>
    </div>
</f:section>

<f:section name="render.pageStepBack">
    <div class="tx-dlf-navigation-back">
        <f:link.action class="page-step-back {f:if(condition: \"{viewData.requestData.page} <= {pageSteps}\", then: \"disabled:\")}" addQueryString="1" addQueryStringMethod="GET" additionalParams="{'tx_dlf[page]':'{viewData.requestData.page - pageSteps}'}">
            <f:translate key="backXPages" arguments="{0: '{pageSteps}'}"/>
        </f:link.action>
    </div>
</f:section>

<f:section name="render.pageBack">
    <div class="tx-dlf-navigation-prev">
        <f:link.action class="page-back {f:if(condition: \"{viewData.requestData.page} <= {viewData.requestData.double + 1}\", then: \"disabled:\")}" addQueryString="1" addQueryStringMethod="GET" additionalParams="{'tx_dlf[page]':'{viewData.requestData.page - 1 - viewData.requestData.double}'}">
            <f:translate key="prevPage"/>
        </f:link.action>
    </div>
</f:section>

<f:section name="render.pageselect">
    <li class="pages">
        <form method="get" action="{f:uri.page(pageUid='{viewData.requestData.pageUid}')}">
            <f:if condition="{viewData.requestData.id}">
                <f:form.hidden name="tx_dlf[id]" value="{viewData.requestData.id}"/>
            </f:if>
            <f:if condition="{viewData.requestData.recordId}">
                <f:form.hidden name="tx_dlf[recordId]" value="{viewData.requestData.recordId}"/>
            </f:if>
            <f:if condition="{viewData.requestData.double}">
                <f:form.hidden name="tx_dlf[double]" value="{viewData.requestData.double}"/>
            </f:if>
            <label for="tx-dlf-page-{viewData.uniqueId}">
                <f:translate key="selectPage"/>
            </label>
            <f:form.select class="page-select" id="tx-dlf-page-{viewData.uniqueId}" name="tx_dlf[page]"
                options="{pageOptions}"
                value="{viewData.requestData.page}">
            </f:form.select>
        </form>
    </li>
</f:section>

<f:section name="render.pageForward">
    <div class="tx-dlf-navigation-next">
        <f:link.action class="page-forward {f:if(condition: \"{viewData.requestData.page + viewData.requestData.double} >= {numPages}\", then: \"disabled:\")}" addQueryString="1" additionalParams="{'tx_dlf[page]':'{viewData.requestData.page + 1 + viewData.requestData.double}'}">
            <f:translate key="nextPage"/>
        </f:link.action>
    </div>
</f:section>

<f:section name="render.pageStepForward">
        <div class="tx-dlf-navigation-fwd">
            <f:link.action class="page-step-forward {f:if(condition: \"{viewData.requestData.page} > {numPages - pageSteps}\", then: \"disabled:\")}" addQueryString="1" addQueryStringMethod="GET" additionalParams="{'tx_dlf[page]':'{viewData.requestData.page + pageSteps}'}">
                <f:translate key="forwardXPages" arguments="{0: '{pageSteps}'}"/>
            </f:link.action>
        </div>
</f:section>

<f:section name="render.pageLast">
    <div class="tx-dlf-navigation-last">
        <f:link.action class="page-last {f:if(condition: \"{viewData.requestData.page} >= {numPages - viewData.requestData.double}\", then: \"disabled:\")}" addQueryString="1" addQueryStringMethod="GET" additionalParams="{'tx_dlf[page]':'{numPages - viewData.requestData.double}'}">
            <f:translate key="lastPage"/>
        </f:link.action>
    </div>
</f:section>

<f:section name="render.listview">
        <div class="tx-dlf-navigation-listview">
            <f:link.page pageUid="{settings.targetPid}">
                <f:translate key="linkToList"/>
            </f:link.page>
        </div>
</f:section>

<f:section name="render.zoom">
    <div class="tx-dlf-navigation-zoom-in">
        <a href="#" title="{f:translate(key: 'zoomIn')}" onclick="tx_dlf_viewer.map.zoomIn();">
            <f:translate key="zoomIn"/>
        </a>
    </div>
    <div class="tx-dlf-navigation-zoom-out">
        <a href="#" title="{f:translate(key: 'zoomOut')}" onclick="tx_dlf_viewer.map.zoomOut();">
            <f:translate key="zoomOut"/>
        </a>
    </div>
    <div class="tx-dlf-navigation-fullscreen">
        <a href="#" title="{f:translate(key: 'zoomFullscreen')}">
            <f:translate key="zoomFullscreen"/>
        </a>
    </div>
</f:section>

<f:section name="render.rotation">
    <div class="tx-dlf-navigation-rotate-left">
        <a href="#" title="{f:translate(key: 'rotateLeft')}" onclick="tx_dlf_viewer.map.rotateLeft();">
            <f:translate key="rotateLeft"/>
        </a>
    </div>
    <div class="tx-dlf-navigation-rotate-right">
        <a href="#" title="{f:translate(key: 'rotateRight')}" onclick="tx_dlf_viewer.map.rotateRight();">
            <f:translate key="rotateRight"/>
        </a>
    </div>
    <div class="tx-dlf-navigation-rotate-reset">
        <a href="#" title="{f:translate(key: 'rotateReset')}" onclick="tx_dlf_viewer.map.resetRotation();">
            <f:translate key="rotateReset"/>
        </a>
    </div>
</f:section>

<script>
    // NOTE: The navigation plugin may be instantiated multiple times, even on a single page view
    document.addEventListener('DOMContentLoaded', () => {
        const features = {features -> f:format.json() -> f:format.raw()};
        const pageSteps = {pageSteps};
        const pageSelect = {pageSelect};

        new dlfNavigation({ features, pageSteps });
    });
</script>
</html>
